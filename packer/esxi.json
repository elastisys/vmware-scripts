{
    "builders": [
      {
        "boot_command": [
            "<enter><enter><f6><esc><wait>",
            "autoinstall ds=nocloud-net",
            "<enter>"
        ],
        "boot_wait": "4s",
        "cd_files": ["{{user `cd_dir`}}/user-data", "{{user `cd_dir`}}/meta-data"],
        "cd_label": "cidata",        
        "cpus": "{{ user `cpu` }}",
        "guest_os_type": "ubuntu64Guest",
        "http_directory": "http",
        "insecure_connection": "true",
        "iso_url": "https://releases.ubuntu.com/focal/ubuntu-20.04.1-live-server-amd64.iso",
        "iso_checksum":"file:https://releases.ubuntu.com/focal/SHA256SUMS",
        "password": "{{user `esxi_password`}}",
        "pause_before_connecting": "10s",
        "shutdown_command": "sudo poweroff",
        "ssh_host": "{{ user `ssh_host` }}",
        "ssh_password": "Gl@$$wall",
        "ssh_timeout": "15m",
        "ssh_username": "{{user `ssh_user`}}",
        "storage": [
          {
            "disk_size": "50000"
          }
        ],
        "type": "vsphere-iso",
        "username": "{{user `esxi_username`}}",
        "vcenter_server": "pcc-145-239-249-136.ovh.uk",
        "datacenter": "pcc-145-239-249-136_datacenter869",
        "cluster": "Cluster1",
        "datastore": "ssd-000844",
        "network_adapters": [
            {
              "network": "VM Network"
            }
          ],
        "vm_name": "{{ user `vm_name` }}",
        "vm_version": "15"
      }
    ],
    "provisioners": [
      {
        "inline": [
          "sudo apt update",
          "sudo apt upgrade -y"
        ],
        "type": "shell"
      },
      {
        "execute_command": "chmod +x {{.Path}}; sudo {{.Path}}",
        "script": "scripts/network/network.sh",
        "type": "shell"
      },
      {
        "execute_command": "chmod +x {{.Path}}; {{.Path}}",
        "script": "scripts/config/init-config.sh",
        "type": "shell"
      },
      {
        "destination": "/tmp/",
        "source": "./setup",
        "type": "file"
      },
      {
        "inline": [
          "chmod +x /tmp/setup/setup.sh",
          "cd /tmp/setup",
          "./setup.sh"
        ],
        "type": "shell"
      },
      {
        "execute_command": "chmod +x {{.Path}}; sudo {{.Path}}",
        "script": "scripts/cleanup/cleanup.sh",
        "type": "shell"
      }
    ],
    "variables": {}
  }